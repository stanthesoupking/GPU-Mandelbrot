!function(n){var t={};function e(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return n[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=n,e.c=t,e.d=function(n,t,o){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:o})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)e.d(o,i,function(t){return n[t]}.bind(null,i));return o},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=0)}([function(n,t,e){var o=e(1);window.onload=function(){(new o).start()}},function(n,t){function e(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}var o=0,i=1,r=function(){function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n)}var t,r,u;return t=n,(r=[{key:"start",value:function(){this.canvas=document.querySelector("#glCanvas"),this.mandelbrotOffset=[0,0],this.mandelbrotZoom=4,this.initWebGl(),this.initEvents(),this.resizeCanvas(),this.render(i)}},{key:"initWebGl",value:function(){this.gl=this.canvas.getContext("webgl");var n=this.gl;if(null!==n){var t=function(n,t,e){var o=c(n,n.VERTEX_SHADER,t),i=c(n,n.FRAGMENT_SHADER,e),r=n.createProgram();return n.attachShader(r,o),n.attachShader(r,i),n.linkProgram(r),n.getProgramParameter(r,n.LINK_STATUS)?r:(alert("Unable to initialize the shader program: "+n.getProgramInfoLog(r)),null)}(n,a,s);this.programInfo={program:t,attribLocations:{vertexPosition:n.getAttribLocation(t,"aVertexPosition")},uniformLocations:{canvasResolutionPosition:n.getUniformLocation(t,"uCanvasResolution"),canvasAspectRatioPosition:n.getUniformLocation(t,"uCanvasAspectRatio"),mandelbrotOffsetPosition:n.getUniformLocation(t,"uOffset"),mandelbrotZoomPosition:n.getUniformLocation(t,"uZoom"),samplesPosition:n.getUniformLocation(t,"uSamples"),iterationsPosition:n.getUniformLocation(t,"uIterations")}},this.positionBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.positionBuffer),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,1,1,1,-1,-1,1,-1]),n.STATIC_DRAW)}else alert("Unable to initialize WebGL. Your browser or machine may not support it.")}},{key:"render",value:function(n){var t=this.gl;this.setDetailLevel(n),this.updateUniforms(),t.clearColor(0,0,0,1),t.clearDepth(1),t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer);var e=t.FLOAT;t.vertexAttribPointer(this.programInfo.attribLocations.vertexPosition,2,e,!1,0,0),t.enableVertexAttribArray(this.programInfo.attribLocations.vertexPosition),t.useProgram(this.programInfo.program);var o=Date.now();t.drawArrays(t.TRIANGLE_STRIP,0,4);var i=Date.now()-o;console.log("Finished in "+i+"ms")}},{key:"updateUniforms",value:function(){var n=this.gl;n.useProgram(this.programInfo.program),n.uniform2f(this.programInfo.uniformLocations.canvasResolutionPosition,this.canvasSize.width,this.canvasSize.height),n.uniform1f(this.programInfo.uniformLocations.canvasAspectRatioPosition,this.canvasAspectRatio),n.uniform2f(this.programInfo.uniformLocations.mandelbrotOffsetPosition,this.mandelbrotOffset[0],this.mandelbrotOffset[1]),n.uniform1f(this.programInfo.uniformLocations.mandelbrotZoomPosition,this.mandelbrotZoom),n.uniform1i(this.programInfo.uniformLocations.iterationsPosition,this.mandelbrotIterations),n.uniform1i(this.programInfo.uniformLocations.samplesPosition,this.mandelbrotSamples)}},{key:"resizeCanvas",value:function(){this.canvas.width=document.body.clientWidth,this.canvas.height=document.body.clientHeight,this.canvasSize={width:this.canvas.width,height:this.canvas.height},this.canvasAspectRatio=this.canvasSize.width/this.canvasSize.height;var n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,this.canvasSize.width,this.canvasSize.height)}},{key:"initEvents",value:function(){var n,t,e=this;window.addEventListener("resize",(function(){e.resizeCanvas(),e.render()}));var r=function(i){var r=i.screenX,a=i.screenY;e.mandelbrotOffset[0]+=.001*(n-r),e.mandelbrotOffset[1]+=.001*(t-a),n=r,t=a,e.render(o)},a=function n(){window.removeEventListener("mousemove",r,!1),window.removeEventListener("mouseup",n,!1),e.render(i)};window.addEventListener("mousedown",(function(e){n=e.screenX,t=e.screenY,window.addEventListener("mousemove",r),window.addEventListener("mouseup",a)})),window.addEventListener("wheel",(function(n){var t=n.deltaY;e.mandelbrotZoom+=.01*t,e.render(o)}))}},{key:"setDetailLevel",value:function(n){switch(n){case o:this.mandelbrotIterations=256,this.mandelbrotSamples=1;break;case i:this.mandelbrotIterations=1024,this.mandelbrotSamples=2}}}])&&e(t.prototype,r),u&&e(t,u),n}(),a="\n    attribute vec4 aVertexPosition;\n\n    uniform mat4 uModelViewMatrix;\n    uniform mat4 uProjectionMatrix;\n\n    void main() {\n        gl_Position = aVertexPosition;\n    }\n",s="\n    precision mediump float;\n\n    uniform int uSamples;\n    uniform int uIterations;\n\n    uniform vec2 uCanvasResolution;\n    uniform float uCanvasAspectRatio;\n\n    uniform vec2 uOffset;\n    uniform float uZoom;\n\n    vec2 ss_to_uv(vec2 pos) {\n        return ((pos.xy * vec2(uCanvasAspectRatio,1)) / uCanvasResolution) - vec2(0.5, 0.5);\n    }\n\n    void main() {\n        const int max_iterations = 1024;\n        const int max_samples = 2;\n\n        int s = 0;\n        bool complete = false;\n\n        int sampleAcc = 0;\n\n        for(int x = 0; x < max_samples; x++) {\n            if(x >= uSamples) {\n                break;\n            }\n\n            for(int y = 0; y < max_samples; y++) {\n                if(y >= uSamples) {\n                    break;\n                }\n\n                s = 0;\n                vec2 spos = vec2(gl_FragCoord.x + float(x), gl_FragCoord.y + float(y));\n                vec2 cpos = (vec2(uOffset.x, -uOffset.y) + ss_to_uv(spos)) * uZoom;\n                vec2 opos = cpos;\n\n                for(int i = 0; i < max_iterations + 1; i++) {\n                    if(!(cpos.x * cpos.x + cpos.y * cpos.y < 2.0 * 2.0)) {\n                        break;\n                    }\n        \n                    float xtemp = cpos.x * cpos.x - cpos.y * cpos.y + opos.x;\n                    cpos.y = 2.0 * cpos.x * cpos.y + opos.y;\n                    cpos.x = xtemp;\n        \n                    s += 1;\n                    if (s > uIterations) {\n                        s = 0;\n                        break;\n                    }\n                }\n                sampleAcc += s;\n            }\n        }\n\n        float m = (float(sampleAcc) / float(uSamples * uSamples)) / float(uIterations);\n\n        gl_FragColor = vec4(m, m, m, 1.0);\n    }\n";function c(n,t,e){var o=n.createShader(t);return n.shaderSource(o,e),n.compileShader(o),n.getShaderParameter(o,n.COMPILE_STATUS)?o:(alert("An error occurred compiling the shaders: "+n.getShaderInfoLog(o)),n.deleteShader(o),null)}n.exports=r}]);